(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50],{14034:function(e,s,t){"use strict";t.d(s,{Z:function(){return o}});var a=t(50044),l=t(2265),n=t(16737),r=t(37517),i=t(93568),d=t(76503);let c=(0,i.fn)("Divider"),o=l.forwardRef((e,s)=>{let{className:t}=e,i=(0,a.__rest)(e,["className"]);return l.createElement("div",Object.assign({ref:s,className:(0,d.q)(c("root"),"w-full mx-auto","bg-tremor-background-subtle","dark:bg-dark-tremor-background-subtle",n.N.threeXs.height,r.W.threeXl.marginTop,r.W.threeXl.marginBottom,t)},i))});o.displayName="Divider"},62166:function(e,s,t){Promise.resolve().then(t.bind(t,66790))},66790:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return EarnPage}});var a=t(57437),l=t(73479),n=t(72009),r=t(8580),i=t(14389),d=t(86825),c=t(2265);let o={};var m=t(54415),u=t(43003),x=t(81628),h=t(68497),b=t(20373),k=t(14034),p=t(87456),f=t(57042),v=t(16691),j=t.n(v),g=t(43977),T=t(79352),y=t(56926),N=t(76036),w=t(34776),A=t(80547),S=t(51549),_=t(72084),E=t(64020),R=t(8332);function TokenValue(e){let{symbol:s,value:t,decimals:l}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(j(),{className:"inline-block",alt:"usb",width:16,height:16,src:"/".concat(s,".svg")}),(0,b.dq)(t,l)]})}function DualTokenCard(e){let{type:s,vc:t}=e,v="buy"==s,j=(0,i.p)(),P=v?n.O1[j]:t.assetTokenAddress,M=v?t.assetTokenAddress:t.xTokenAddress,q=v?"USB":t.assetTokenSymbol,B=v?t.assetTokenSymbol:"USB",D=v?"Buy ".concat(t.assetTokenSymbol," Low"):"Sell ".concat(t.assetTokenSymbol," High"),C=v?t.ptyPoolBelowAddress:t.ptyPoolAboveAddress,{prices:H,balances:z,earns:U,vaultsState:V,assetLocked:Z,vaultUSBTotal:I,usbApr:J}=(0,c.useContext)(h.g),F=V[t.vault],W=U[C],{address:Y}=(0,y.mA)(),L=z[P],[O,G]=(0,c.useState)(""),X=(0,x.su)(O),$=v?t.xTokenSymbol:t.assetTokenSymbol,K=v?t.assetTokenSymbol:t.xTokenSymbol;(0,c.useMemo)(()=>W.totalStake*(0,x.ok)(H,P,r.Pq)/r.Pq,[H[P],W.totalStake]);let Q=v?null==F?void 0:F.AARS:null==F?void 0:F.AARU,ee=(0,x.ok)(Z,t.assetTokenAddress),es=(0,x.ok)(I,t.vault),et=(0,c.useMemo)(()=>Q&&F.AARDecimals&&0n!=ee&&0n!=es?Q*es*r.Pq/F.AARDecimals/ee/BigInt(1e9):(0,x.ok)(H,t.assetTokenAddress),[Q,es,F.AARDecimals,ee]),ea=v?"Stake $USB, and when the ".concat(t.assetTokenSymbol," price falls to the target, it will trigger the purchase of ").concat(t.assetTokenSymbol," with staked $USB."):"Stake ".concat(t.assetTokenSymbol,", and when the ").concat(t.assetTokenSymbol," price rises to the target, staked ").concat(t.assetTokenSymbol," will be sold."),el=(0,m.D2)({abi:l.aT,address:C,functionName:"getAccruedMatchingYields"}),en=(0,x.ok)(el,"data"),er=(0,c.useMemo)(()=>{let e=(0,x.ok)(W,"totalStake");if(0n==e||0n==H[P])return"0.00%";let s=10n**(F.AARDecimals||10n),t=(F.AART-s)*et;if(0n==t)return"0.00%";let a=v?(F.AART*F.M_USB_ETH*r.Pq-F.M_ETH*et*s)/(F.AART-s)/r.Pq:(F.M_ETH*et*s-F.AART*F.M_USB_ETH*r.Pq)/t;return e=(0,x.NA)([e,a]),(0,x.Jh)(en*H[M]*r.Pq/(e*H[P]),18,3)},[W.totalStake,en,M,P,H[M],H[P],v]),ei=(0,d.i)(),ed=(0,x.ok)(ei[C],"staking"),ec=H[t.assetTokenAddress]>0&&et>0n?v?(H[t.assetTokenAddress]-et)*10n**10n/H[t.assetTokenAddress]:(et-H[t.assetTokenAddress])*10n**10n/H[t.assetTokenAddress]:0n,eo=(0,c.useMemo)(()=>{let e=10n**(F.AARDecimals||10n),s=(F.AART-e)*et/e;if(0n==s)return 0n;if(v){let t=(F.AART*F.M_USB_ETH*r.Pq-F.M_ETH*et*e)/e/s,a=t*et/r.Pq,l=W.stake,n=W.totalStake>a?l*a/W.totalStake:l;return n}{let t=(F.M_ETH*et*e-F.AART*F.M_USB_ETH*r.Pq)/e/s,a=W.stake,l=W.totalStake>t?a*t/W.totalStake:a;return l}},[W,F,v,et]),em=(0,c.useMemo)(()=>{let e=v?[{key:"eth_price",label:"ETH Price",value:(0,b.dq)(H[t.assetTokenAddress])},{key:"target_price",label:"Target Price",value:(0,a.jsxs)("div",{children:[(0,b.dq)(et),"(",(0,a.jsxs)("span",{className:"text-red-600",children:["-",(0,x.Jh)(ec,10)]}),")"]}),groupEnd:!0},{key:"apr_interest",label:"APY",value:(0,x.Jh)(J.apr+ed,J.aprDecimals,2),detail:(0,a.jsxs)("div",{className:"pl-2",children:[(0,a.jsxs)("div",{children:["~USB Interest: ",(0,x.Jh)(J.apr,J.aprDecimals,2)]}),(0,a.jsxs)("div",{children:["~",$," Yield: ",(0,x.Jh)(ed,J.aprDecimals,2)]})]}),groupEnd:!0},{key:"transacation_reward_pool",label:"Reward Pool",tip:"The reward funds originates from protocol, and when a purchase action is triggered, these funds will be distributed proportionally.",value:(0,a.jsx)(TokenValue,{symbol:K,value:en})},{key:"discount_rate",label:"Reward Rate",tip:"This is an estimated value, to be determined upon triggering. Reward Rate =Reward/Transaction volume",value:"".concat(er," (Est.)")}]:[{key:"eth_price",label:"ETH Price",value:(0,b.dq)(H[t.assetTokenAddress])},{key:"target_price",label:"Target Price",value:(0,a.jsxs)("div",{children:[(0,b.dq)(et),"(",(0,a.jsxs)("span",{className:"text-green-600",children:["+",(0,x.Jh)(ec,10)]}),")"]}),groupEnd:!0},{key:"apr_yield",label:"APY(".concat($," Yield)"),value:(0,x.Jh)(ed,J.aprDecimals,2),groupEnd:!0},{key:"transacation_reward_pool",label:"Reward Pool",tip:"The reward funds originates from protocol, and when a sell action is triggered, these funds will be distributed proportionally.",value:(0,a.jsx)(TokenValue,{symbol:K,value:en})},{key:"discount_rate",label:"Reward Rate",tip:"This is an estimated value, to be determined upon triggering. Reward Rate =Reward/Transaction volume",value:"".concat(er," (Est.)")}];return e},[W,en]),eu=(0,c.useMemo)(()=>{let e=v?[{key:"successfully_brought",label:"Successfully Bought",value:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(TokenValue,{symbol:B,value:W.match}),(0,a.jsx)("span",{children:"+"}),(0,a.jsx)(TokenValue,{symbol:K,value:W.earnForMatch}),(0,a.jsx)(E.C,{inFlex:!0,children:"From Reward Pool"})]})},{key:"staking_earend",label:"".concat($," earned"),value:(0,a.jsx)(TokenValue,{symbol:$,value:W.earn})}]:[{key:"successfully_sold",label:"Successfully Sold",value:(0,a.jsx)(TokenValue,{symbol:B,value:W.match})},{key:"match_earend",label:"".concat(K," earned"),value:(0,a.jsx)(TokenValue,{symbol:K,value:W.earnForMatch})}];return e},[W,B,$,K]),{write:ex,isDisabled:eh,isLoading:eb}=(0,u.R)({abi:l.aT,address:C,functionName:"claimAll"}),ek=function(e){let s=(0,c.useRef)(null);return o[e]&&o[e].includes(s)||(o[e]=[...o[e]||[],s]),(0,c.useEffect)(()=>{if(!s.current)return()=>{};let onResize=()=>{let t=o[e]||[],a=t.reduce((e,s)=>{var t;return Math.max((null===(t=s.current)||void 0===t?void 0:t.clientHeight)||0,e)},0);t.filter(e=>e!=s).forEach(e=>{var s;let t=(null===(s=e.current)||void 0===s?void 0:s.clientHeight)||0;t!==a&&a>0&&e.current&&(e.current.style.height="".concat(a,"px"))})};return window.addEventListener("resize",onResize),onResize(),()=>{window.removeEventListener("resize",onResize)}},[s.current]),s}(t.vault),ep=(0,R.IS)(),ef=ep.find(e=>e.symbol==q);return(0,a.jsxs)("div",{className:"card flex flex-col",children:[(0,a.jsxs)("div",{className:"flex gap-5 items-center justify-between",ref:ek,children:[(0,a.jsxs)("div",{className:"flex gap-3 md:gap-5 items-center",children:[(0,a.jsxs)("div",{className:"relative w-fit shrink-0",children:[(0,a.jsx)(S.c,{size:32,symbol:q,className:"md:hidden"}),(0,a.jsx)(S.c,{size:40,symbol:q,className:"hidden md:block"}),(0,a.jsx)(S.c,{size:16,symbol:B,className:"absolute -right-1 -bottom-1 md:hidden"}),(0,a.jsx)(S.c,{size:24,symbol:B,className:"absolute -right-2 -bottom-2 hidden md:block"})]}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h6",{className:"page-sub",children:D||"title"}),(0,a.jsx)(E.C,{children:ea})]})})]}),!v&&(0,a.jsxs)("div",{className:"font-medium text-indigo-500 text-xs items-center hidden md:block",children:[(0,a.jsxs)("span",{className:"font-semibold text-sm",children:[(0,b.dq)(302400n*(0,g.v)("0.06504987",18),0)," Blast Points"]}),(0,a.jsxs)("div",{className:"flex w-full items-center justify-center gap-1",children:["per 1 ",(0,a.jsx)(S.c,{symbol:"ETH",size:14})," /Week"]})]}),v&&ef&&(0,a.jsxs)("div",{className:"font-medium text-indigo-500 text-xs items-center hidden md:block",children:[(0,a.jsxs)("span",{className:"font-semibold text-sm",children:[ef.point," Blast Points"]}),(0,a.jsxs)("div",{className:"flex w-full items-center justify-center gap-1",children:["per ",ef.per," ",(0,a.jsx)(S.c,{symbol:ef.symbol,size:14})," /Week"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-xs text-black font-medium text-right",children:["Total ",q," Staked"]}),(0,a.jsx)("div",{className:"text-base text-black text-end font-semibold",children:(0,b.dq)(W.totalStake)})]})]}),(0,a.jsx)(k.Z,{className:"my-4"}),(0,a.jsxs)(p.Z,{numItemsSm:2,className:"gap-x-2 min-h-[188px]",children:[(0,a.jsx)(p.Z,{numItemsSm:1,className:"gap-y-2 gap-x-7 md:border-r-[1px] border-[#E4E4E7] mb-3 md:mb-0 ",children:null==em?void 0:em.map(e=>(0,a.jsxs)("div",{className:(0,f.Z)("flex flex-col text-sm",{"mb-4":e.groupEnd}),children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"text-black font-medium mr-[5px]",children:[e.label," : ",e.tip&&(0,a.jsx)(E.C,{children:e.tip})]}),(0,a.jsx)("div",{className:"text-neutral-900",children:e.value})]}),e.detail]},e.key))}),Y&&(0,a.jsxs)(p.Z,{numItemsSm:1,className:"gap-x-1",children:[(0,a.jsx)("div",{className:"w-full border-t-[1px] border-[#E4E4E7] md:border-0 md:px-[20px]",children:null==eu?void 0:eu.map(e=>(0,a.jsxs)("div",{className:"flex items-center mt-[8px] md:mt-0 md:mb-2",children:[(0,a.jsxs)("div",{className:"text-xs text-black font-medium mr-[5px]",children:[e.label," :"]}),(0,a.jsx)("div",{className:"text-neutral-900 text-sm",children:e.value})]},e.key))}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"w-full flex justify-center items-center",children:(0,a.jsxs)("button",{className:"btn-primary px-4 h-7 flex items-center w-[60%] md:w-fit self-end justify-center gap-4 bg-[#64738B]",disabled:eh||eb,onClick:()=>ex(),children:[eb&&(0,a.jsx)(_.$,{}),"Claim All"]})}),(0,a.jsxs)("div",{className:"relative flex flex-col gap-1 mt-4 md:mt-[28px] justify-center items-center text-[#64748B] text-sm font-medium p-3 rounded-md bg-slate-100",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["Staked",(0,a.jsx)(S.c,{symbol:q,size:16}),(0,b.dq)(W.stake),(0,a.jsx)("span",{className:"text-[#6466F1] ml-[5px] cursor-pointer",onClick:()=>G((0,T.d)(W.stake)),children:"Max"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 pl-8",children:["-",(0,b.dq)(eo),(0,a.jsxs)(E.C,{inFlex:!0,children:["This is the amount of staked ",q," that will be ",v?"spent":"sold"," when price triggers."]})]})]})]})]})]}),(0,a.jsx)("div",{className:"flex-1"}),Y?(0,a.jsxs)("div",{className:"mt-4 md:mt-[30px]",children:[(0,a.jsx)(A.W,{amount:O,setAmount:G,asset:q,balance:L,checkBalance:!1}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(N.v,{tx:"Stake",disabled:X<=0n||X>L,onTxSuccess:()=>{G("")},config:{abi:l.aT,address:C,functionName:"stake",args:[X],value:"ETH"==q?X:0n},className:"mt-2 w-[45%]",approves:{[P]:X},spender:C}),(0,a.jsx)(N.v,{className:"mt-2 w-[45%]",tx:"Withdraw",disabled:X<=0n||X>W.stake,onTxSuccess:()=>{G("")},config:{abi:l.aT,address:C,functionName:"withdraw",args:[X]}})]})]}):(0,a.jsx)("div",{className:"w-full flex items-center justify-center mt-[30px]",children:(0,a.jsx)(w.Z,{})})]})}function GroupDualTokenCard(e){let{vcs:s,type:t}=e,[l,n]=(0,c.useState)(s[s.length-1]);return 0==s.length?null:1==s.length?(0,a.jsx)(DualTokenCard,{vc:s[0],type:t}):(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(DualTokenCard,{vc:l,type:t}),(0,a.jsx)("div",{className:"absolute z-10 left-[86px] top-0 flex text-sm",children:s.map((e,s)=>(0,a.jsx)("div",{className:(0,f.Z)("cursor-pointer rounded-b-full border border-blue-500 px-1 py-1",{"bg-white text-black":l!==e,"bg-blue-500 text-white":l===e}),onClick:()=>n(e),children:"V".concat(s+1)},"gdtc_"+s))})]})}var P=t(55139);function EarnPage(){let e=(0,i.p)(),s=(0,c.useMemo)(()=>n.iK[e].filter(e=>"ETH"==e.assetTokenSymbol),[e]);return(0,a.jsxs)("div",{className:"w-full h-full max-w-screen-xl px-4 mx-auto",children:[(0,a.jsx)("h2",{className:"page-title",children:"Price Trigger Yield"}),(0,a.jsxs)(P.r,{numItemsMd:2,className:"gap-3 mt-4",children:[(0,a.jsx)(GroupDualTokenCard,{vcs:s,type:"buy"}),(0,a.jsx)(GroupDualTokenCard,{vcs:s,type:"sell"})]})]})}}},function(e){e.O(0,[1866,9472,1787,6682,1439,336,2536,8881,5224,8070,9727,1261,4764,2971,2472,1744],function(){return e(e.s=62166)}),_N_E=e.O()}]);